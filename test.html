<!DOCTYPE html>
<html>
<head>
    <title>팀편성과 순위 페이지</title>
    <style>
        /* CSS 스타일링 */
        body {
            font-family: Arial, sans-serif;
        }
        table {
            border-collapse: collapse;
            width: 50%;
            margin: 20px auto;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: center;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <h2>학생 등록</h2>
    <input type="text" id="studentName" placeholder="학생 이름">
    <button onclick="addStudent()">등록</button>

    <h2>팀 편성</h2>
    <table>
        <tr>
            <th>팀명</th>
            <th>학생</th>
            <th>점수</th>
            <th>부여</th>
        </tr>
        <tbody id="teamTable">
            <!-- 여기에 팀 정보가 자동으로 추가될 예정 -->
        </tbody>
    </table>

    <h2>학생 정보</h2>
    <table>
        <tr>
            <th>학생</th>
            <th>팀명</th>
            <th>점수</th>
            <th>부여</th>
        </tr>
        <tbody id="studentTable">
            <!-- 여기에 학생 정보가 자동으로 추가될 예정 -->
        </tbody>
    </table>

    <h2>순위</h2>
    <table>
        <tr>
            <th>순위</th>
            <th>팀</th>
        </tr>
        <tbody id="rankTable">
            <!-- 여기에 순위 정보가 자동으로 추가될 예정 -->
        </tbody>
    </table>

    <script>
        const students = [];
        const teams = {};

        function addStudent() {
            const studentName = document.getElementById('studentName').value;
            const teamName = prompt(`${studentName}의 팀명을 입력하세요:`);

            if (!teams[teamName]) {
                teams[teamName] = {
                    name: teamName,
                    members: [],
                };
            }

            teams[teamName].members.push({ name: studentName, score: 0 });
            document.getElementById('studentName').value = '';
            displayStudents();
            displayTeams();
        }

        function updateScore(type, teamName) {
            const scoreInput = document.getElementById(`teamScoreInput-${teamName}`);
            const score = parseInt(scoreInput.value);

            if (type === 'team') {
                teams[teamName].members.forEach((member) => {
                    member.score = score;
                });
            }

            displayStudents();
            displayTeams();
        }

        // function updateScore2(type, index) {
        //     if (type === 'student') {
        //         const scoreInput = document.getElementById('studentScoreInput-' + index);
        //         students[index].score = students[index].score + parseInt(scoreInput.value);
        //     } 
            
        //     displayStudents();
        //     displayTeams();
        // }

        function displayStudents() {
            const studentTable = document.getElementById('studentTable');
            studentTable.innerHTML = '';

            for (const teamName in teams) {
                const members = teams[teamName].members;
                for (let i = 0; i < members.length; i++) {
                    const row = studentTable.insertRow();
                    row.insertCell().textContent = members[i].name;
                    row.insertCell().textContent = teamName;
                    row.insertCell().textContent = members[i].score;
                    const cell = row.insertCell();
                    cell.innerHTML = `
                        <input type="number" min="0" max="100" id="studentScoreInput-${teamName}" value="${members[i].score}">
                        <button onclick="updateScore('student', '${teamName}')">점수 부여</button>
                    `;
                }
            }
        }

        function displayTeams() {
            const teamTable = document.getElementById('teamTable');
            teamTable.innerHTML = '';

            for (const teamName in teams) {
                const members = teams[teamName].members;
                const row = teamTable.insertRow();
                row.insertCell().textContent = teamName;
                row.insertCell().textContent = members.map((member) => member.name).join(', ');
                row.insertCell().textContent = members[0].score; // Displaying the first member's score for simplicity
                const cell = row.insertCell();
                cell.innerHTML = `
                    <input type="number" min="0" max="100" id="teamScoreInput-${teamName}" value="${members[0].score}">
                    <button onclick="updateScore('team', '${teamName}')">점수 부여</button>
                `;
            }
        }

        function showRankings() {
            rankTable.innerHTML = '';
            const sortedTeams = Object.values(teams).sort((a, b) => {
                const totalScoreA = a.members.reduce((acc, cur) => acc + cur.score, 0);
                const totalScoreB = b.members.reduce((acc, cur) => acc + cur.score, 0);
                return totalScoreB - totalScoreA;
            });

            for (let i = 0; i < sortedTeams.length; i++) {
                const row = rankTable.insertRow();
                row.insertCell().textContent = i + 1;
                row.insertCell().textContent = sortedTeams[i].name;
            }
        }
    </script>
</body>
</html>
